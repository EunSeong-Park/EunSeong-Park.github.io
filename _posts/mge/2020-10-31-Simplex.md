---
title: "Simplex Method"
tags: OR Management-Engineering
toc: true
---

# Intro
**Simplex method**는 LP에서 최적해를 구하기 위한 알고리즘이다. 일반적인 방법과 절차를 알아보고, 몇 가지 케이스의 예제를 풀어보자.

# Background
## Review of Linear Algebra
$m \times n $ 행렬 $\mathbf A$와 $m \times 1$ 행렬 $\mathbf b$에 대하여, $\mathbf {Ax = b}$와 같은 linear system을 생각해보자. 또, $m \le n$이며, 행렬 $\mathbf A$에게서 $m \times m$ 행렬 $\mathbf B$를 빼내어 $\mathbf{A = (B\; \vert\; N)}$과 같이 나타낼 수 있고, $r(\mathbf{A}) = r(\mathbf B) = m$임을 가정할 것이다. 우리는 이러한 상황에서 해당 시스템에 대한 general solution을 이끌어내는 방법을 다시 떠올려 볼 것이다.

우선, $\mathbf{(B \;\; N)\binom{x_B}{x_N}} = \mathbf b$로 시스템을 변형하자. $\mathbf x_B$는 **basic(dependent) variable**에 대한 벡터, $\mathbf x_N$은 **non-basic(free) variable**에 대한 벡터다. 아무튼, $\mathbf {Bx_B +Nx_N=b}$라는 사실에 근거하여, $\mathbf x_B = \mathbf B^{-1}\mathbf b-\mathbf B^{-1}\mathbf N \mathbf x_N$으로 general solution을 나타낼 수 있겠다.

## BFS
이에 더하여, $\mathbf x_N = \bar 0$를 가정하면, $\mathbf x_B = \mathbf B^{-1}\mathbf b$가 되고, 그에 따른 $\mathbf x = \binom{\mathbf B^{-1}\mathbf b}{\bar 0}$는 해당 linear system의 **basic solution(BS)** 이 된다. 또, 만약 $\mathbf x_B = \mathbf B^{-1}\mathbf b \ge \bar 0$이라면, $\mathbf x$는 **basic feasible solution(BFS)** 라고 불린다.

또한, $\mathbf B^{-1}\mathbf b$ 각각의 엔트리가 positive하다면, $\mathbf x$는 **non-degenerate BFS**, 최소 하나 이상의 엔트리가 $0$이라면 **degenerate BFS**라고 한다.

### Theorem 1
$\mathbf x$가 $S=${$y: \mathbf {Ay} = \mathbf b, y \ge \bar 0$}의 한 **EP**면, $\mathbf x$는 **BFS**고, 역 또한 성립한다.
{:.success}

### Theorem 2
$S = ${$x: \mathbf {Ax=b}, \mathbf x \ge 0$}가 공집합이 아니며, $r(\mathbf A) = m$이라면, $\mathbf {Ax=b}$는 최소 하나 이상의 **BFS**를 가진다.
{:.success}

# Simplex Method
우리가 LP를 graphical하게 해결할 때, (내부의 임의의 점이 아니라) 보통 우리는 polyhedral set이 형성하는 모서리나 꼭짓점만을 고려하여 최적해의 후보를 추린다. **심플렉스법(simplex method)** 은 그러한 아이디어를 기반으로 한다.

## Procedure
예시를 통해 심플렉스법의 절차를 알아보자. 우리는 심플렉스법을 minimization problem으로만 한정한다. 어차피 max 문제도 min 문제로 치환이 가능하니 별 문제는 없다.

아무튼, 다음과 같은 LP problem이 주어짐을 가정한다.

$$\begin{aligned}
\text{Maximize}\quad & z= 5x_1 + 3x_2, \\
\text{Subject to}\quad & 3x_1 + 5x_2 \le 15 \\
& 5x_1 + 2x_2 \le 10 \\
&x_1, x_2 \ge 0
\end{aligned}
$$

### Step 1
가장 먼저, 주어진 LP를 **simplex tableau**로 표현해야 한다. 이는 심플렉스법의 핵심이 되는데, 그 전에 우리는 주어진 LP를 standard form으로 변환해야 한다.

우선, 해당 문제를 standard form으로 바꾸어주기 위해 slack variable, $x_3, x_4$를 도입하자. 

$$\begin{aligned}
\text{Maximize}\quad & z= 5x_1 + 3x_2, \\
\text{Subject to}\quad & 3x_1 + 5x_2 + x_3 \quad\quad\; = 15 \\
& 5x_1 + 2x_2 \;\quad\quad + x_4 = 10 \\
&x_1, x_2,x_3,x_4 \ge 0
\end{aligned}
$$

이제, 위 문제를 minimization problem으로 바꾼다.

$$\begin{aligned}
\text{Minimize}\quad & z= -5x_1 - 3x_2, \\
\text{Subject to}\quad & 3x_1 + 5x_2 + x_3 \quad\quad\; = 15 \\
& 5x_1 + 2x_2 \;\quad\quad + x_4 = 10 \\
&x_1, x_2,x_3,x_4 \ge 0
\end{aligned}
$$

마지막으로, 문제를 벡터 표현으로 고치고, simplex tableau를 만든다.

$$\begin{aligned}
\text{Minimize}\quad & z\\
\quad & z+5x_1+3x_2+0x_3+0x_4 = 0 \\
& x_1\binom{3}{5} +x_2\binom{5}{2}+x_3\binom{1}{0}+x_4\binom{0}{1} = \binom{15}{10} \\
&all\;\;x_j \ge 0\end{aligned}
$$

Row | $z$ | $x_1\quad x_2 \quad x_3 \quad x_4$ | RHS | $B_s$ | $c_B$ | $\theta$
---|---|---|---|---|---|---
$0$ | $1$ | $5\;\;\quad 3\quad\;\; 0\quad\;\;0$ | $0$
$1$ | $0$ | $3\;\;\quad 5\quad\;\; 1\quad\;\;0$ | $15$ | $a_3$ | $0$ | $ {15\over 3}= 5(\theta_1)$
$2$ | $0$ | $5\;\;\quad 2\quad\;\; 0\quad\;\;1$ | $10$ | $a_4$ | $0$ | $ {10\over 5}= 2(\theta_2)$

노테이션을 정리하고 가자.

- $B_s$: 